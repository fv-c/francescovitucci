$(document).ready(function(){function t(t){var i=$("#filters");i.append('<button data-filter="all">All works</button>'),i.append('<button data-filter="none" class="active">None</button>'),t.forEach(function(t){const s=e[t]||t;i.append(`<button data-filter="${t}">${s}</button>`)}),$("#filters button").click(function(){var t=$(this).attr("data-filter");if($("#filters button").removeClass("active").each(function(){var t=$(this).attr("data-original-text");t&&$(this).text(t)}),$(this).addClass("active"),s(t),"none"!==t){var i=a?a.filter(i=>"all"===t||"none"!==t&&i.instruments.includes(t)).length:0;$(this).attr("data-original-text",$(this).attr("data-original-text")||$(this).text()),$(this).text(`${$(this).attr("data-original-text")} (${i})`)}}),$("#filters button").each(function(){$(this).attr("data-original-text",$(this).text())})}function i(t){var i=$("#works");i.empty(),t.forEach(function(t){var s=`\n        <div class="work">\n            <div class="workCardWrapper">\n                <div class="workCard">\n                    <h2 class="workTitle">${t.title}</h2>\n                    <p class="workSubtitle">${t.subtitle}</p>\n                    <p class="workYear">${t.year}</p>\n                    <img class="workImage" src="../assets/img/works/${t.image}">\n                    <p class="workDuration">${t.duration}</p>\n                    <hr>\n                    <div class="premiereWrapper"><p class="workPremiere">${t.premiere}</p></div>\n                    <hr>\n                    <p class="workDescription">${t.description}</p>\n                    <hr>\n                    <div class="linksWrapper">`;t.soundcloud_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/soundcloud.svg"><a href="${t.soundcloud_url}" target="_blank" class="workSoundcloudLink">Listen on SoundCloud</a></div>`),t.genericplay_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/headphones.svg"><a href="${t.genericplay_url}" target="_blank" class="workGenericPlayLink">Listen!</a></div>`),t.youtube_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/youtube.svg"><a href="${t.youtube_url}" target="_blank" class="workYoutubeLink">Watch on YouTube</a></div>`),t.spotify_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/spotify.svg"><a href="${t.spotify_url}" target="_blank" class="workSpotifyLink">Listen on Spotify</a></div>`),t.buy_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/cart.svg"><a href="${t.buy_url}" target="_blank" class="workBuyLink">Buy the score</a></div>`),t.info1_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/info.svg"><a href="${t.info1_url}" target="_blank" class="workInfoLink">What they say about...</a></div>`),t.info2_url&&(s+=`<div class="workLink"><img class="workLinkIcon" src="../assets/img/icons/info.svg"><a href="${t.info2_url}" target="_blank" class="workInfoLink">what they say about...</a></div>`),s+="\n                        </div>\n                        <hr>",t.read&&(s+=`<a href="${t.read}" target="_blank" class="workReadMore">Read more</a>`),s+="</div>\n                </div>\n            </div>",i.append(s)})}function s(t){var s;a?((s="all"===t?a.slice():"none"===t?[]:a.filter(function(i){return i.instruments.includes(t)})).sort(function(t,i){if(i.year!==t.year)return i.year-t.year;const s=t.premiere.slice(-10).split("-").reverse().join("-");return i.premiere.slice(-10).split("-").reverse().join("-").localeCompare(s)}),i(s)):console.error("I dati dei brani non sono stati caricati correttamente.")}var a,r=new Set;const e={liveElectronics:"live electronics",fixedMedia:"fixed media"};$("#loading-message").show();var n=0,o=(new Date).getTime();$.getJSON("../assets/works.json?t="+o,function(i){a=i,$("#loading-message").hide(),$("#filters, #works").show(),a.forEach(function(t){t.instruments.forEach(function(t){r.add(t)})}),t(Array.from(r))}).fail(function(){console.error("Errore nel caricamento del file JSON.")}),$("#filters button").click(function(){var t=$(this).attr("data-filter");$("#filters button").removeClass("active").each(function(){var t=$(this).attr("data-original-text");t&&$(this).text(t)}),$(this).addClass("active"),s(t),$("#workCount").remove(),n=a?a.filter(i=>"all"===t||"none"!==t&&i.instruments.includes(t)).length:0,$("#filters").after($('<div id="workCount"></div>').text("Works found: "+n))}),$("#filters button").each(function(){$(this).attr("data-original-text",$(this).text())})});